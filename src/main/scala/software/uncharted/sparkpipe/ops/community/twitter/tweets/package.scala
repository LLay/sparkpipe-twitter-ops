/*
 * Copyright 2016 Uncharted Software Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package software.uncharted.sparpipe.ops.community.twitter

import org.apache.spark.sql.{SQLContext, DataFrame}
import org.apache.spark.sql.types.{StructType, StructField, BooleanType, StringType, LongType}

import software.uncharted.sparkpipe.ops.core.dataframe.io._

/**
 * This package contains a twitter pipeline operations for Spark
 * See the README or {@link software.uncharted.sparkpipe.Pipe} for more information.
 */
package object tweets {

  val TWEET_SCHEMA = StructType(Seq(StructField("contributors",StringType,true), StructField("coordinates",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("created_at",StringType,true), StructField("entities",StructType(Seq(StructField("hashtags",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true))),true),true), StructField("symbols",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("trends",ArrayType(StringType,true),true), StructField("urls",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("url",StringType,true))),true),true), StructField("user_mentions",ArrayType(StructType(Seq(StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("name",StringType,true), StructField("screen_name",StringType,true))),true),true))),true), StructField("extended_entities",StructType(Seq(StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true), StructField("video_info",StructType(Seq(StructField("aspect_ratio",ArrayType(LongType,true),true), StructField("duration_millis",LongType,true), StructField("variants",ArrayType(StructType(Seq(StructField("bitrate",LongType,true), StructField("content_type",StringType,true), StructField("url",StringType,true))),true),true))),true))),true),true))),true), StructField("favorite_count",LongType,true), StructField("favorited",BooleanType,true), StructField("filter_level",StringType,true), StructField("geo",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("in_reply_to_screen_name",StringType,true), StructField("in_reply_to_status_id",LongType,true), StructField("in_reply_to_status_id_str",StringType,true), StructField("in_reply_to_user_id",LongType,true), StructField("in_reply_to_user_id_str",StringType,true), StructField("lang",StringType,true), StructField("place",StructType(Seq(StructField("bounding_box",StructType(Seq(StructField("coordinates",ArrayType(ArrayType(ArrayType(DoubleType,true),true),true),true), StructField("type",StringType,true))),true), StructField("country",StringType,true), StructField("country_code",StringType,true), StructField("full_name",StringType,true), StructField("id",StringType,true), StructField("name",StringType,true), StructField("place_type",StringType,true), StructField("url",StringType,true))),true), StructField("possibly_sensitive",BooleanType,true), StructField("quoted_status",StructType(Seq(StructField("contributors",StringType,true), StructField("coordinates",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("created_at",StringType,true), StructField("entities",StructType(Seq(StructField("hashtags",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true))),true),true), StructField("symbols",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("trends",ArrayType(StringType,true),true), StructField("urls",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("url",StringType,true))),true),true), StructField("user_mentions",ArrayType(StructType(Seq(StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("name",StringType,true), StructField("screen_name",StringType,true))),true),true))),true), StructField("extended_entities",StructType(Seq(StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true), StructField("video_info",StructType(Seq(StructField("aspect_ratio",ArrayType(LongType,true),true), StructField("duration_millis",LongType,true), StructField("variants",ArrayType(StructType(Seq(StructField("bitrate",LongType,true), StructField("content_type",StringType,true), StructField("url",StringType,true))),true),true))),true))),true),true))),true), StructField("favorite_count",LongType,true), StructField("favorited",BooleanType,true), StructField("filter_level",StringType,true), StructField("geo",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("in_reply_to_screen_name",StringType,true), StructField("in_reply_to_status_id",LongType,true), StructField("in_reply_to_status_id_str",StringType,true), StructField("in_reply_to_user_id",LongType,true), StructField("in_reply_to_user_id_str",StringType,true), StructField("lang",StringType,true), StructField("place",StringType,true), StructField("possibly_sensitive",BooleanType,true), StructField("quoted_status_id",LongType,true), StructField("quoted_status_id_str",StringType,true), StructField("retweet_count",LongType,true), StructField("retweeted",BooleanType,true), StructField("scopes",StructType(Seq(StructField("followers",BooleanType,true))),true), StructField("source",StringType,true), StructField("text",StringType,true), StructField("truncated",BooleanType,true), StructField("user",StructType(Seq(StructField("contributors_enabled",BooleanType,true), StructField("created_at",StringType,true), StructField("default_profile",BooleanType,true), StructField("default_profile_image",BooleanType,true), StructField("description",StringType,true), StructField("favourites_count",LongType,true), StructField("follow_request_sent",StringType,true), StructField("followers_count",LongType,true), StructField("following",StringType,true), StructField("friends_count",LongType,true), StructField("geo_enabled",BooleanType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("is_translator",BooleanType,true), StructField("lang",StringType,true), StructField("listed_count",LongType,true), StructField("location",StringType,true), StructField("name",StringType,true), StructField("notifications",StringType,true), StructField("profile_background_color",StringType,true), StructField("profile_background_image_url",StringType,true), StructField("profile_background_image_url_https",StringType,true), StructField("profile_background_tile",BooleanType,true), StructField("profile_banner_url",StringType,true), StructField("profile_image_url",StringType,true), StructField("profile_image_url_https",StringType,true), StructField("profile_link_color",StringType,true), StructField("profile_sidebar_border_color",StringType,true), StructField("profile_sidebar_fill_color",StringType,true), StructField("profile_text_color",StringType,true), StructField("profile_use_background_image",BooleanType,true), StructField("protected",BooleanType,true), StructField("screen_name",StringType,true), StructField("statuses_count",LongType,true), StructField("time_zone",StringType,true), StructField("url",StringType,true), StructField("utc_offset",LongType,true), StructField("verified",BooleanType,true))),true))),true), StructField("quoted_status_id",LongType,true), StructField("quoted_status_id_str",StringType,true), StructField("retweet_count",LongType,true), StructField("retweeted",BooleanType,true), StructField("retweeted_status",StructType(Seq(StructField("contributors",StringType,true), StructField("coordinates",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("created_at",StringType,true), StructField("entities",StructType(Seq(StructField("hashtags",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true))),true),true), StructField("symbols",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("trends",ArrayType(StringType,true),true), StructField("urls",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("url",StringType,true))),true),true), StructField("user_mentions",ArrayType(StructType(Seq(StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("name",StringType,true), StructField("screen_name",StringType,true))),true),true))),true), StructField("extended_entities",StructType(Seq(StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true), StructField("video_info",StructType(Seq(StructField("aspect_ratio",ArrayType(LongType,true),true), StructField("duration_millis",LongType,true), StructField("variants",ArrayType(StructType(Seq(StructField("bitrate",LongType,true), StructField("content_type",StringType,true), StructField("url",StringType,true))),true),true))),true))),true),true))),true), StructField("favorite_count",LongType,true), StructField("favorited",BooleanType,true), StructField("filter_level",StringType,true), StructField("geo",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("in_reply_to_screen_name",StringType,true), StructField("in_reply_to_status_id",LongType,true), StructField("in_reply_to_status_id_str",StringType,true), StructField("in_reply_to_user_id",LongType,true), StructField("in_reply_to_user_id_str",StringType,true), StructField("lang",StringType,true), StructField("place",StructType(Seq(StructField("bounding_box",StructType(Seq(StructField("coordinates",ArrayType(ArrayType(ArrayType(DoubleType,true),true),true),true), StructField("type",StringType,true))),true), StructField("country",StringType,true), StructField("country_code",StringType,true), StructField("full_name",StringType,true), StructField("id",StringType,true), StructField("name",StringType,true), StructField("place_type",StringType,true), StructField("url",StringType,true))),true), StructField("possibly_sensitive",BooleanType,true), StructField("quoted_status",StructType(Seq(StructField("contributors",StringType,true), StructField("coordinates",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("created_at",StringType,true), StructField("entities",StructType(Seq(StructField("hashtags",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true))),true),true), StructField("symbols",ArrayType(StructType(Seq(StructField("indices",ArrayType(LongType,true),true), StructField("text",StringType,true))),true),true), StructField("trends",ArrayType(StringType,true),true), StructField("urls",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("url",StringType,true))),true),true), StructField("user_mentions",ArrayType(StructType(Seq(StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("name",StringType,true), StructField("screen_name",StringType,true))),true),true))),true), StructField("extended_entities",StructType(Seq(StructField("media",ArrayType(StructType(Seq(StructField("display_url",StringType,true), StructField("expanded_url",StringType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("indices",ArrayType(LongType,true),true), StructField("media_url",StringType,true), StructField("media_url_https",StringType,true), StructField("sizes",StructType(Seq(StructField("large",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("medium",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("small",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true), StructField("thumb",StructType(Seq(StructField("h",LongType,true), StructField("resize",StringType,true), StructField("w",LongType,true))),true))),true), StructField("source_status_id",LongType,true), StructField("source_status_id_str",StringType,true), StructField("type",StringType,true), StructField("url",StringType,true), StructField("video_info",StructType(Seq(StructField("aspect_ratio",ArrayType(LongType,true),true), StructField("duration_millis",LongType,true), StructField("variants",ArrayType(StructType(Seq(StructField("bitrate",LongType,true), StructField("content_type",StringType,true), StructField("url",StringType,true))),true),true))),true))),true),true))),true), StructField("favorite_count",LongType,true), StructField("favorited",BooleanType,true), StructField("filter_level",StringType,true), StructField("geo",StructType(Seq(StructField("coordinates",ArrayType(DoubleType,true),true), StructField("type",StringType,true))),true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("in_reply_to_screen_name",StringType,true), StructField("in_reply_to_status_id",LongType,true), StructField("in_reply_to_status_id_str",StringType,true), StructField("in_reply_to_user_id",LongType,true), StructField("in_reply_to_user_id_str",StringType,true), StructField("lang",StringType,true), StructField("place",StringType,true), StructField("possibly_sensitive",BooleanType,true), StructField("quoted_status_id",LongType,true), StructField("quoted_status_id_str",StringType,true), StructField("retweet_count",LongType,true), StructField("retweeted",BooleanType,true), StructField("source",StringType,true), StructField("text",StringType,true), StructField("truncated",BooleanType,true), StructField("user",StructType(Seq(StructField("contributors_enabled",BooleanType,true), StructField("created_at",StringType,true), StructField("default_profile",BooleanType,true), StructField("default_profile_image",BooleanType,true), StructField("description",StringType,true), StructField("favourites_count",LongType,true), StructField("follow_request_sent",StringType,true), StructField("followers_count",LongType,true), StructField("following",StringType,true), StructField("friends_count",LongType,true), StructField("geo_enabled",BooleanType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("is_translator",BooleanType,true), StructField("lang",StringType,true), StructField("listed_count",LongType,true), StructField("location",StringType,true), StructField("name",StringType,true), StructField("notifications",StringType,true), StructField("profile_background_color",StringType,true), StructField("profile_background_image_url",StringType,true), StructField("profile_background_image_url_https",StringType,true), StructField("profile_background_tile",BooleanType,true), StructField("profile_banner_url",StringType,true), StructField("profile_image_url",StringType,true), StructField("profile_image_url_https",StringType,true), StructField("profile_link_color",StringType,true), StructField("profile_sidebar_border_color",StringType,true), StructField("profile_sidebar_fill_color",StringType,true), StructField("profile_text_color",StringType,true), StructField("profile_use_background_image",BooleanType,true), StructField("protected",BooleanType,true), StructField("screen_name",StringType,true), StructField("statuses_count",LongType,true), StructField("time_zone",StringType,true), StructField("url",StringType,true), StructField("utc_offset",LongType,true), StructField("verified",BooleanType,true))),true))),true), StructField("quoted_status_id",LongType,true), StructField("quoted_status_id_str",StringType,true), StructField("retweet_count",LongType,true), StructField("retweeted",BooleanType,true), StructField("source",StringType,true), StructField("text",StringType,true), StructField("truncated",BooleanType,true), StructField("user",StructType(Seq(StructField("contributors_enabled",BooleanType,true), StructField("created_at",StringType,true), StructField("default_profile",BooleanType,true), StructField("default_profile_image",BooleanType,true), StructField("description",StringType,true), StructField("favourites_count",LongType,true), StructField("follow_request_sent",StringType,true), StructField("followers_count",LongType,true), StructField("following",StringType,true), StructField("friends_count",LongType,true), StructField("geo_enabled",BooleanType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("is_translator",BooleanType,true), StructField("lang",StringType,true), StructField("listed_count",LongType,true), StructField("location",StringType,true), StructField("name",StringType,true), StructField("notifications",StringType,true), StructField("profile_background_color",StringType,true), StructField("profile_background_image_url",StringType,true), StructField("profile_background_image_url_https",StringType,true), StructField("profile_background_tile",BooleanType,true), StructField("profile_banner_url",StringType,true), StructField("profile_image_url",StringType,true), StructField("profile_image_url_https",StringType,true), StructField("profile_link_color",StringType,true), StructField("profile_sidebar_border_color",StringType,true), StructField("profile_sidebar_fill_color",StringType,true), StructField("profile_text_color",StringType,true), StructField("profile_use_background_image",BooleanType,true), StructField("protected",BooleanType,true), StructField("screen_name",StringType,true), StructField("statuses_count",LongType,true), StructField("time_zone",StringType,true), StructField("url",StringType,true), StructField("utc_offset",LongType,true), StructField("verified",BooleanType,true))),true))),true), StructField("scopes",StructType(Seq(StructField("place_ids",ArrayType(StringType,true),true))),true), StructField("source",StringType,true), StructField("text",StringType,true), StructField("timestamp_ms",StringType,true), StructField("truncated",BooleanType,true), StructField("user",StructType(Seq(StructField("contributors_enabled",BooleanType,true), StructField("created_at",StringType,true), StructField("default_profile",BooleanType,true), StructField("default_profile_image",BooleanType,true), StructField("description",StringType,true), StructField("favourites_count",LongType,true), StructField("follow_request_sent",StringType,true), StructField("followers_count",LongType,true), StructField("following",StringType,true), StructField("friends_count",LongType,true), StructField("geo_enabled",BooleanType,true), StructField("id",LongType,true), StructField("id_str",StringType,true), StructField("is_translator",BooleanType,true), StructField("lang",StringType,true), StructField("listed_count",LongType,true), StructField("location",StringType,true), StructField("name",StringType,true), StructField("notifications",StringType,true), StructField("profile_background_color",StringType,true), StructField("profile_background_image_url",StringType,true), StructField("profile_background_image_url_https",StringType,true), StructField("profile_background_tile",BooleanType,true), StructField("profile_banner_url",StringType,true), StructField("profile_image_url",StringType,true), StructField("profile_image_url_https",StringType,true), StructField("profile_link_color",StringType,true), StructField("profile_sidebar_border_color",StringType,true), StructField("profile_sidebar_fill_color",StringType,true), StructField("profile_text_color",StringType,true), StructField("profile_use_background_image",BooleanType,true), StructField("protected",BooleanType,true), StructField("screen_name",StringType,true), StructField("statuses_count",LongType,true), StructField("time_zone",StringType,true), StructField("url",StringType,true), StructField("utc_offset",LongType,true), StructField("verified",BooleanType,true))),true)))

  /**
  * Create a DataFrame from an input data source
  *
  * @param path A format-specific location String for the source data
  * @param format Specifies the input data source format (parquet by default)
  * @param options A Map[String, String] of options
  * @return a DataFrame createad from the specified source
  */
  def read(
    path: String,
    format: String = "parquet",
    options: Map[String, String] = Map[String, String](),
    schema: StructType = new StructType(Array[StructField]())
    )(sqlContext: SQLContext): DataFrame = {
      read(path, format, options, TWEET_SCHEMA)
    }
}
